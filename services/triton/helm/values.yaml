replicaCount: 1

image:
  repository: "478253497479.dkr.ecr.us-east-1.amazonaws.com/triton"
  tag: "24.01-py3"        # use the tag you pushed to ECR
  pullPolicy: Always      # force fresh pulls

args:
  - "--model-repository=/models"
  - "--model-control-mode=poll"
  - "--repository-poll-secs=5"
  - "--log-verbose=1"
  - "--log-info=true"
  - "--log-warning=true"
  - "--log-error=true"


serviceAccount:
  create: true
  name: triton-sa
  annotations: {}
    # IRSA annotation can be added here if needed
    # eks.amazonaws.com/role-arn: arn:aws:iam::478253497479:role/triton-pod-role

resources:
  limits:
    nvidia.com/gpu: 1
    ephemeral-storage: 18Gi
    cpu: "2"
    memory: 10Gi
  requests:
    cpu: "1"
    memory: 6Gi
    ephemeral-storage: 15Gi

nodeSelector:
  accelerator: nvidia

tolerations:
  - key: "nvidia.com/gpu"
    operator: "Exists"
    effect: "NoSchedule"

# Disable S3 model repo since youâ€™re using EFS
modelRepo:
  s3:
    bucket: ""
    prefix: ""
    region: ""

ports:
  http: 8000
  grpc: 8001
  metrics: 8002

service:
  type: ClusterIP
  port: 8000   # required by schema

metrics:
  enabled: true
  path: /metrics
  port: 8002

livenessProbe:
  enabled: true
  path: /v2/health/ready
  port: 8000
  initialDelaySeconds: 10
  timeoutSeconds: 5
  periodSeconds: 10

readinessProbe:
  enabled: true
  path: /v2/health/live
  port: 8000
  initialDelaySeconds: 5
  timeoutSeconds: 5
  periodSeconds: 10

persistence:
  enabled: true
  existingClaim: triton-models-pvc   # bind to your PVC
  mountName: model-repo
  path: /models                      # PVC will be mounted here

extraEnv:
  - name: AWS_REGION
    value: "us-east-1"
